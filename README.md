# 🔄 スケジュール＆Notion同期ツール README

本ツールは、現在アクティブになっているスプレッドシートのスケジュールデータを、集約用の別スプレッドシートおよびNotionデータベースへ自動で同期・連携するGoogle Apps Script (GAS) です。

## ✨ 主な機能

* **スプレッドシートへの集約同期**: 表示中のシートデータを、指定した集約先シートへ統合します。案件が新規の場合は自動で末尾に列を追加し、左隣の列から書式（1〜9行目）や数式（2行目）をコピーしてフォーマットを維持します。
* **最古日付の優先抽出**: 予定データの入力欄に「確認出し」や「納品」が複数回設定されている場合、日付が最も古いもの（最初に見つかった日付）を優先して抽出・記録します。
* **Notionデータベース連携**: 案件名（プロジェクト名）をキーにしてNotionを検索し、既存ページがあればプロパティを更新（Update）、無ければ新規ページを作成（Create）します。
* **Notionの初期値自動設定**: Notionへ新規登録する際のみ、自動的に `Priority` プロパティ（セレクトプロパティ）を `Middle` に設定します。

---

## ⚙️ 実行前の準備（前提条件）

### 1. CONFIG設定
GASエディタを開き、コード上部の `CONFIG` 内に以下の情報を入力してください。
* `DEST_SPREADSHEET_ID`: 同期先（集約用）となるスプレッドシートのID
* `DEST_SHEET_NAME`: 同期先シート名（デフォルト: `【進行入力用】レタッチスケジュール`）
* `NOTION_API_KEY`: NotionのインテグレーションAPIキー
* `NOTION_DB_ID`: データを入れるNotionデータベースのID

### 2. シートのレイアウト要件
本スクリプトは以下のセル・行・列の配置を前提として動作します。

**【同期元シート】**
* **D6セル**: 担当者名
* **D8セル**: 校正フラグ（「有」または「あり」という文字が含まれるとNotion上でチェックが入ります）
* **7行目**: カット数
* **8行目**: 売価
* **11行目**: 案件名（プロジェクト名）
* **12行目以降（A列）**: 日付
* **G列以降**: 案件ごとのスケジュールデータ

**【同期先シート】**
* **3行目**: 案件名（この行を見て既存データか新規データかを判定します）
* **12行目以降（A列）**: 日付
* **C列以降**: 案件ごとの同期データ書き込み先

---

## 🚀 使い方

1. スプレッドシートを開き、同期させたいシートを表示（アクティブに）します。
2. 上部メニューに表示される「同期メニュー」から「【表示中のシート】を集約シート＆Notionへ同期」をクリックします。
3. 実行確認のダイアログが表示されるので、「はい」をクリックします。
4. 「同期が完了しました。」というメッセージが出れば処理完了です。
